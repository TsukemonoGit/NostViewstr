import{e as Se}from"../chunks/kind.df02593b.js";import{J as ke,l as te,c as me}from"../chunks/bookmarkEvents.1341752b.js";import{X as Ce,s as we,e as $,i as J,r as ie,d as b,y as D,o as ye,f as S,l as se,a as F,g as C,h as R,m as oe,c as P,R as Oe,j as y,C as g,L as pe,x as W,w as Re,n as ae,F as Ie,p as G,W as re,T as M,H as De,I as He}from"../chunks/scheduler.b8cd85ff.js";import{S as Ee,i as Ne,p as fe,b as K,d as Q,m as Y,a as A,t as j,c as Je,e as Z,g as Ae}from"../chunks/index.35665f17.js";import{a as Te,p as ue,d as L,e as _e}from"../chunks/settings.88550f80.js";import{H as Fe,F as Pe,g as Ve,i as ne,r as q,a as he,N as je,L as Le,p as le,b as Be}from"../chunks/FooterMenu.1197af10.js";import{a as ze}from"../chunks/navigation.3f69098d.js";import{m as ce,t as X}from"../chunks/store.967fbeb2.js";import{v as Ue}from"../chunks/index.ee7fcb47.js";const qe=({params:e})=>{if(Ce(ke)===void 0)throw Se(404,"Not Found")},ut=Object.freeze(Object.defineProperty({__proto__:null,load:qe},Symbol.toStringTag,{value:"Module"})),We='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M5 5c0 .55.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1zm2.41 9H9v5c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-5h1.59c.89 0 1.34-1.08.71-1.71L12.71 7.7a.996.996 0 0 0-1.41 0l-4.59 4.59c-.63.63-.19 1.71.7 1.71z"/></svg>';function be(e){let s,t,o=(e[3][0].title??"(title missing)")+"",f,i,l,r=(e[3][0].body??"(title missing)")+"",c,_,p,k,h,E,w,N="Publish",d,n,a=e[0].buttonTextCancel+"",m,T,O,B;return{c(){s=S("div"),t=S("header"),f=se(o),i=F(),l=S("article"),c=se(r),_=F(),p=S("textarea"),k=F(),h=S("footer"),E=S("div"),w=S("button"),w.textContent=N,d=F(),n=S("button"),m=se(a),this.h()},l(H){s=C(H,"DIV",{class:!0});var v=R(s);t=C(v,"HEADER",{class:!0});var z=R(t);f=oe(z,o),z.forEach(b),i=P(v),l=C(v,"ARTICLE",{});var U=R(l);c=oe(U,r),U.forEach(b),_=P(v),p=C(v,"TEXTAREA",{class:!0,placeholder:!0}),R(p).forEach(b),k=P(v),h=C(v,"FOOTER",{class:!0});var u=R(h);E=C(u,"DIV",{class:!0});var I=R(E);w=C(I,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Oe(w)!=="svelte-1maqem3"&&(w.textContent=N),d=P(I),n=C(I,"BUTTON",{type:!0,class:!0});var V=R(n);m=oe(V,a),V.forEach(b),I.forEach(b),u.forEach(b),v.forEach(b),this.h()},h(){y(t,"class",Ge),y(p,"class","input p-2 m-2 my-4 h-60 max-w-[768px] overflow-y-auto break-words whitespace-pre-wrap"),y(p,"placeholder",""),y(w,"type","button"),y(w,"class","btn variant-filled-secondary p-1"),y(n,"type","button"),y(n,"class","btn variant-filled-surface p-2"),y(E,"class","flex flex-wrap gap-2"),y(h,"class",T="modal-footer "+e[0].regionFooter+" mt-2"),y(s,"class","modal-example-form "+$e+" bg-surface-200-700-token w-[90%] max-w-[768px]")},m(H,v){J(H,s,v),g(s,t),g(t,f),g(s,i),g(s,l),g(l,c),g(s,_),g(s,p),pe(p,e[2]),e[6](p),g(s,k),g(s,h),g(h,E),g(E,w),g(E,d),g(E,n),g(n,m),O||(B=[W(p,"input",e[5]),W(w,"click",e[7]),W(n,"click",function(){Re(e[0].onClose)&&e[0].onClose.apply(this,arguments)})],O=!0)},p(H,v){e=H,v&8&&o!==(o=(e[3][0].title??"(title missing)")+"")&&ae(f,o),v&8&&r!==(r=(e[3][0].body??"(title missing)")+"")&&ae(c,r),v&4&&pe(p,e[2]),v&1&&a!==(a=e[0].buttonTextCancel+"")&&ae(m,a),v&1&&T!==(T="modal-footer "+e[0].regionFooter+" mt-2")&&y(h,"class",T)},d(H){H&&b(s),e[6](null),O=!1,Ie(B)}}}function Xe(e){let s,t=e[3][0]&&be(e);return{c(){t&&t.c(),s=$()},l(o){t&&t.l(o),s=$()},m(o,f){t&&t.m(o,f),J(o,s,f)},p(o,[f]){o[3][0]?t?t.p(o,f):(t=be(o),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},i:ie,o:ie,d(o){o&&b(s),t&&t.d(o)}}}const $e="card p-4  shadow-xl  break-all",Ge="text-2xl font-bold";function Ke(e,s,t){var N,d;let o,f,i;D(e,Te,n=>t(9,o=n)),D(e,ue,n=>t(10,f=n)),D(e,ce,n=>t(3,i=n));let{parent:l}=s,r;ye(()=>{r&&t(1,r.scrollTop=0,r)});let c=JSON.stringify((d=(N=i[0])==null?void 0:N.value)==null?void 0:d.event,void 0,4),_;function p(){console.log(_),i[0].response&&i[0].response(_),ce.close()}function k(){try{const n=JSON.parse(c);if(n.pubkey=f,n.created_at=Math.floor(Date.now()/1e3),n.id="",n.sig="",!Ue(n))throw new Error;_=n,p()}catch(n){const a={message:o("toast.invalidEvent"),timeout:3e3,background:"bg-orange-500 text-white width-filled "};X.trigger(a),console.log(n)}}function h(){c=this.value,t(2,c)}function E(n){G[n?"unshift":"push"](()=>{r=n,t(1,r)})}const w=()=>k();return e.$$set=n=>{"parent"in n&&t(0,l=n.parent)},[l,r,c,i,k,h,E,w]}class Qe extends Ee{constructor(s){super(),Ne(this,s,Ke,Xe,we,{parent:0})}}function ve(e){let s,t;return s=new je({props:{relays:e[4][e[6]].searchRelays,$$slots:{default:[Ye]},$$scope:{ctx:e}}}),{c(){K(s.$$.fragment)},l(o){Q(s.$$.fragment,o)},m(o,f){Y(s,o,f),t=!0},p(o,f){const i={};f&16&&(i.relays=o[4][o[6]].searchRelays),f&33554439&&(i.$$scope={dirty:f,ctx:o}),s.$set(i)},i(o){t||(A(s.$$.fragment,o),t=!0)},o(o){j(s.$$.fragment,o),t=!1},d(o){Z(s,o)}}}function Ye(e){let s,t,o;function f(l){e[16](l)}let i={pubkey:e[6],listEvent:e[2],DeleteNote:e[7],MoveNote:e[8],CheckNote:e[9],isOwner:e[1],noEdit:!0};return e[0]!==void 0&&(i.bkm=e[0]),s=new Le({props:i}),G.push(()=>fe(s,"bkm",f)),{c(){K(s.$$.fragment)},l(l){Q(s.$$.fragment,l)},m(l,r){Y(s,l,r),o=!0},p(l,r){const c={};r&4&&(c.listEvent=l[2]),r&2&&(c.isOwner=l[1]),!t&&r&1&&(t=!0,c.bkm=l[0],re(()=>t=!1)),s.$set(c)},i(l){o||(A(s.$$.fragment,l),o=!0)},o(l){j(s.$$.fragment,l),o=!1},d(l){Z(s,l)}}}function ge(e){let s,t,o,f,i,l;return{c(){s=S("div"),t=S("div"),o=S("button"),f=new De(!1),this.h()},l(r){s=C(r,"DIV",{class:!0});var c=R(s);t=C(c,"DIV",{class:!0});var _=R(t);o=C(_,"BUTTON",{class:!0});var p=R(o);f=He(p,!1),p.forEach(b),_.forEach(b),c.forEach(b),this.h()},h(){f.a=null,y(o,"class","addIcon btn-icon variant-filled-secondary fill-white hover:variant-ghost-secondary hover:stroke-secondary-500 overflow-x-hidden"),y(t,"class","fill-white overflow-x-hidden h-fit overflow-y-auto"),y(s,"class","fixed bottom-14 z-10 box-border overflow-x-hidden add svelte-1436lvs")},m(r,c){J(r,s,c),g(s,t),g(t,o),f.m(We,o),i||(l=W(o,"click",e[10]),i=!0)},p:ie,d(r){r&&b(s),i=!1,l()}}}function Ze(e){let s,t,o,f,i,l,r,c,_,p,k,h;function E(a){e[14](a)}function w(a){e[15](a)}let N={kind:e[5].kind,pubkey:e[6],JSON:!0};e[0]!==void 0&&(N.bkm=e[0]),e[2]!==void 0&&(N.viewEvent=e[2]),s=new Fe({props:N}),G.push(()=>fe(s,"bkm",E)),G.push(()=>fe(s,"viewEvent",w));let d=e[4]&&e[4][e[6]]&&e[4][e[6]].searchRelays&&e[4][e[6]].searchRelays.length>0&&ve(e);_=new Pe({props:{pubkey:e[5].pubkey,kind:e[5].kind,disabled:!0}});let n=!e[3]&&ge(e);return{c(){K(s.$$.fragment),f=F(),i=S("div"),l=S("div"),r=S("main"),d&&d.c(),c=F(),K(_.$$.fragment),p=F(),n&&n.c(),k=$(),this.h()},l(a){Q(s.$$.fragment,a),f=P(a),i=C(a,"DIV",{class:!0});var m=R(i);l=C(m,"DIV",{class:!0});var T=R(l);r=C(T,"MAIN",{class:!0});var O=R(r);d&&d.l(O),O.forEach(b),T.forEach(b),m.forEach(b),c=P(a),Q(_.$$.fragment,a),p=P(a),n&&n.l(a),k=$(),this.h()},h(){y(r,"class","flex-1 overflow-y-auto h-fit overflow-x-hidden pb-[2em]"),y(l,"class","flex overflow-x-hidden"),y(i,"class","mb-12 mt-16 container max-w-[1024px] h-full mx-auto justify-center items-center box-border")},m(a,m){Y(s,a,m),J(a,f,m),J(a,i,m),g(i,l),g(l,r),d&&d.m(r,null),J(a,c,m),Y(_,a,m),J(a,p,m),n&&n.m(a,m),J(a,k,m),h=!0},p(a,[m]){const T={};m&32&&(T.kind=a[5].kind),!t&&m&1&&(t=!0,T.bkm=a[0],re(()=>t=!1)),!o&&m&4&&(o=!0,T.viewEvent=a[2],re(()=>o=!1)),s.$set(T),a[4]&&a[4][a[6]]&&a[4][a[6]].searchRelays&&a[4][a[6]].searchRelays.length>0?d?(d.p(a,m),m&16&&A(d,1)):(d=ve(a),d.c(),A(d,1),d.m(r,null)):d&&(Ae(),j(d,1,1,()=>{d=null}),Je());const O={};m&32&&(O.pubkey=a[5].pubkey),m&32&&(O.kind=a[5].kind),_.$set(O),a[3]?n&&(n.d(1),n=null):n?n.p(a,m):(n=ge(a),n.c(),n.m(k.parentNode,k))},i(a){h||(A(s.$$.fragment,a),A(d),A(_.$$.fragment,a),h=!0)},o(a){j(s.$$.fragment,a),j(d),j(_.$$.fragment,a),h=!1},d(a){a&&(b(f),b(i),b(c),b(p),b(k)),Z(s,a),d&&d.d(),Z(_,a),n&&n.d(a)}}}function xe(e,s,t){let o,f,i,l,r,c,_,p,k;D(e,L,u=>t(3,o=u)),D(e,Te,u=>t(18,f=u)),D(e,ue,u=>t(12,i=u)),D(e,q,u=>t(4,l=u)),D(e,ke,u=>t(5,r=u)),D(e,te,u=>t(19,c=u)),D(e,me,u=>t(20,_=u)),D(e,le,u=>t(13,p=u)),D(e,_e,u=>t(21,k=u));let h="pub",E=r,w=r.pubkey,N=!1,d,n,a,m;ye(async()=>{N||(console.log("onMount"),N=!0,await T(),N=!1)}),ze(async()=>{N||(console.log("afterNavigate"),N=!0,M(te,c=0,c),M(le,p=0,p),await T(),N=!1)});const T=async()=>{M(L,o=!0,o),console.log("onMount executed"),await O(w),M(L,o=!1,o)};async function O(u){if(M(te,c=0,c),M(le,p=0,p),M(_e,k=!1,k),t(0,h="pub"),console.log("bkminit"),(i===void 0||i==="")&&M(ue,i=await Ve(),i),!l||!l[u]){M(q,l[u]=ne,l);const I={message:`${f("toast.relaySearching")}`},V=X.trigger(I);M(q,l[u]=ne,l),await he(u),X.close(V)}u!==i&&!l[i]&&(M(q,l[i]=ne,l),he(i))}const B={ref:Qe};function H(u){let I=Object.assign({},r);I.created_at="<generated>",I.sig="<generated>",I.pubkey="<generated>",I.id="<generated>";const V={type:"component",component:B,title:f("modal.publishjson.title"),body:`${f("modal.publishjson.body")}`,value:{event:I},response:async x=>{var de;if(x){M(L,o=!0,o),console.log(x);const ee=await Be(x,((de=l[i])==null?void 0:de.bookmarkRelays)||[]),Me={message:ee.isSuccess?"Add note<br>"+ee.msg:f("toast.failed_publish"),timeout:3e3,background:ee.isSuccess?"variant-filled-secondary width-filled":"bg-orange-500 text-white width-filled "};X.trigger(Me),M(L,o=!1,o)}}};ce.trigger(V)}function v(u){h=u,t(0,h)}function z(u){E=u,t(2,E)}function U(u){h=u,t(0,h)}return e.$$.update=()=>{e.$$.dirty&4096&&t(1,m=i===w),e.$$.dirty&2&&console.log(m),e.$$.dirty&8193&&(p!==-1||h)&&(M(me,_=[],_),window.scrollTo({top:0}))},[h,m,E,o,l,r,w,d,n,a,H,O,i,p,v,z,U]}class ct extends Ee{constructor(s){super(),Ne(this,s,xe,Ze,we,{bkminit:11})}get bkminit(){return this.$$.ctx[11]}}export{ct as component,ut as universal};
